"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1471],{1471:(we,Z,c)=>{c.r(Z),c.d(Z,{HomePageModule:()=>Ze});var P=c(6895),d=c(5274),E=c(4719),w=c(1710),s=c(5861),T=c(6090),A=c(6498),I=c(353),N=c(4241);function D(i){const{subscriber:t,counter:e,period:o}=i;t.next(e),this.schedule({subscriber:t,counter:e+1,period:o},o)}var C=c(3725),n=c(6738),R=c(7323),h=(()=>{return(i=h||(h={})).Normal="Normal",i.Hybrid="Hybrid",i.Satellite="Satellite",i.Terrain="Terrain",i.None="None",h;var i})(),_=c(7423);const l=(0,_.fo)("CapacitorGoogleMaps",{web:()=>c.e(111).then(c.bind(c,111)).then(i=>new i.CapacitorGoogleMapsWeb)});l.addListener("isMapInFocus",i=>{var t;const u=(null===(t=document.elementFromPoint(i.x,i.y)?.dataset)||void 0===t?void 0:t.internalId)===i.mapId;l.dispatchMapEvent({id:i.mapId,focus:u})});class J extends HTMLElement{constructor(){super()}connectedCallback(){if("ios"==_.dV.getPlatform()){this.style.overflow="scroll",this.style["-webkit-overflow-scrolling"]="touch";const t=document.createElement("div");t.style.height="200%",this.appendChild(t)}}}customElements.define("capacitor-google-map",J);class b{constructor(t){this.element=null,this.handleScrollEvent=()=>this.updateMapBounds(),this.id=t}static create(t,e){return(0,s.Z)(function*(){const o=new b(t.id);if(!t.element)throw new Error("container element is required");void 0===t.config.androidLiteMode&&(t.config.androidLiteMode=!1),o.element=t.element,o.element.dataset.internalId=t.id;const r=t.element.getBoundingClientRect();if(t.config.width=r.width,t.config.height=r.height,t.config.x=r.x,t.config.y=r.y,t.config.devicePixelRatio=window.devicePixelRatio,"android"==_.dV.getPlatform()&&o.initScrolling(),_.dV.isNativePlatform()&&(t.element={}),yield l.create(t),e){const a=yield l.addListener("onMapReady",u=>{u.mapId==o.id&&(e(u),a.remove())})}return o})()}enableClustering(){var t=this;return(0,s.Z)(function*(){return l.enableClustering({id:t.id})})()}disableClustering(){var t=this;return(0,s.Z)(function*(){return l.disableClustering({id:t.id})})()}addMarker(t){var e=this;return(0,s.Z)(function*(){return(yield l.addMarker({id:e.id,marker:t})).id})()}addMarkers(t){var e=this;return(0,s.Z)(function*(){return(yield l.addMarkers({id:e.id,markers:t})).ids})()}removeMarker(t){var e=this;return(0,s.Z)(function*(){return l.removeMarker({id:e.id,markerId:t})})()}removeMarkers(t){var e=this;return(0,s.Z)(function*(){return l.removeMarkers({id:e.id,markerIds:t})})()}destroy(){var t=this;return(0,s.Z)(function*(){return"android"==_.dV.getPlatform()&&t.disableScrolling(),t.removeAllMapListeners(),l.destroy({id:t.id})})()}setCamera(t){var e=this;return(0,s.Z)(function*(){return l.setCamera({id:e.id,config:t})})()}setMapType(t){var e=this;return(0,s.Z)(function*(){return l.setMapType({id:e.id,mapType:t})})()}enableIndoorMaps(t){var e=this;return(0,s.Z)(function*(){return l.enableIndoorMaps({id:e.id,enabled:t})})()}enableTrafficLayer(t){var e=this;return(0,s.Z)(function*(){return l.enableTrafficLayer({id:e.id,enabled:t})})()}enableAccessibilityElements(t){var e=this;return(0,s.Z)(function*(){return l.enableAccessibilityElements({id:e.id,enabled:t})})()}enableCurrentLocation(t){var e=this;return(0,s.Z)(function*(){return l.enableCurrentLocation({id:e.id,enabled:t})})()}setPadding(t){var e=this;return(0,s.Z)(function*(){return l.setPadding({id:e.id,padding:t})})()}getMapBounds(){var t=this;return(0,s.Z)(function*(){return l.getMapBounds({id:t.id})})()}initScrolling(){const t=document.getElementsByTagName("ion-content");for(let e=0;e<t.length;e++)t[e].scrollEvents=!0;window.addEventListener("ionScroll",this.handleScrollEvent),window.addEventListener("scroll",this.handleScrollEvent),window.addEventListener("resize",this.handleScrollEvent),screen.orientation?screen.orientation.addEventListener("change",()=>{setTimeout(this.updateMapBounds,500)}):window.addEventListener("orientationchange",()=>{setTimeout(this.updateMapBounds,500)})}disableScrolling(){window.removeEventListener("ionScroll",this.handleScrollEvent),window.removeEventListener("scroll",this.handleScrollEvent),window.removeEventListener("resize",this.handleScrollEvent),screen.orientation?screen.orientation.removeEventListener("change",()=>{setTimeout(this.updateMapBounds,1e3)}):window.removeEventListener("orientationchange",()=>{setTimeout(this.updateMapBounds,1e3)})}updateMapBounds(){if(this.element){const t=this.element.getBoundingClientRect();l.onScroll({id:this.id,mapBounds:{x:t.x,y:t.y,width:t.width,height:t.height}})}}setOnCameraIdleListener(t){var e=this;return(0,s.Z)(function*(){e.onCameraIdleListener&&e.onCameraIdleListener.remove(),e.onCameraIdleListener=t?yield l.addListener("onCameraIdle",e.generateCallback(t)):void 0})()}setOnBoundsChangedListener(t){var e=this;return(0,s.Z)(function*(){e.onBoundsChangedListener&&e.onBoundsChangedListener.remove(),e.onBoundsChangedListener=t?yield l.addListener("onBoundsChanged",e.generateCallback(t)):void 0})()}setOnCameraMoveStartedListener(t){var e=this;return(0,s.Z)(function*(){e.onCameraMoveStartedListener&&e.onCameraMoveStartedListener.remove(),e.onCameraMoveStartedListener=t?yield l.addListener("onCameraMoveStarted",e.generateCallback(t)):void 0})()}setOnClusterClickListener(t){var e=this;return(0,s.Z)(function*(){e.onClusterClickListener&&e.onClusterClickListener.remove(),e.onClusterClickListener=t?yield l.addListener("onClusterClick",e.generateCallback(t)):void 0})()}setOnClusterInfoWindowClickListener(t){var e=this;return(0,s.Z)(function*(){e.onClusterInfoWindowClickListener&&e.onClusterInfoWindowClickListener.remove(),e.onClusterInfoWindowClickListener=t?yield l.addListener("onClusterInfoWindowClick",e.generateCallback(t)):void 0})()}setOnInfoWindowClickListener(t){var e=this;return(0,s.Z)(function*(){e.onInfoWindowClickListener&&e.onInfoWindowClickListener.remove(),e.onInfoWindowClickListener=t?yield l.addListener("onInfoWindowClick",e.generateCallback(t)):void 0})()}setOnMapClickListener(t){var e=this;return(0,s.Z)(function*(){e.onMapClickListener&&e.onMapClickListener.remove(),e.onMapClickListener=t?yield l.addListener("onMapClick",e.generateCallback(t)):void 0})()}setOnMarkerClickListener(t){var e=this;return(0,s.Z)(function*(){e.onMarkerClickListener&&e.onMarkerClickListener.remove(),e.onMarkerClickListener=t?yield l.addListener("onMarkerClick",e.generateCallback(t)):void 0})()}setOnMyLocationButtonClickListener(t){var e=this;return(0,s.Z)(function*(){e.onMyLocationButtonClickListener&&e.onMyLocationButtonClickListener.remove(),e.onMyLocationButtonClickListener=t?yield l.addListener("onMyLocationButtonClick",e.generateCallback(t)):void 0})()}setOnMyLocationClickListener(t){var e=this;return(0,s.Z)(function*(){e.onMyLocationClickListener&&e.onMyLocationClickListener.remove(),e.onMyLocationClickListener=t?yield l.addListener("onMyLocationClick",e.generateCallback(t)):void 0})()}removeAllMapListeners(){var t=this;return(0,s.Z)(function*(){t.onBoundsChangedListener&&(t.onBoundsChangedListener.remove(),t.onBoundsChangedListener=void 0),t.onCameraIdleListener&&(t.onCameraIdleListener.remove(),t.onCameraIdleListener=void 0),t.onCameraMoveStartedListener&&(t.onCameraMoveStartedListener.remove(),t.onCameraMoveStartedListener=void 0),t.onClusterClickListener&&(t.onClusterClickListener.remove(),t.onClusterClickListener=void 0),t.onClusterInfoWindowClickListener&&(t.onClusterInfoWindowClickListener.remove(),t.onClusterInfoWindowClickListener=void 0),t.onInfoWindowClickListener&&(t.onInfoWindowClickListener.remove(),t.onInfoWindowClickListener=void 0),t.onMapClickListener&&(t.onMapClickListener.remove(),t.onMapClickListener=void 0),t.onMarkerClickListener&&(t.onMarkerClickListener.remove(),t.onMarkerClickListener=void 0),t.onMyLocationButtonClickListener&&(t.onMyLocationButtonClickListener.remove(),t.onMyLocationButtonClickListener=void 0),t.onMyLocationClickListener&&(t.onMyLocationClickListener.remove(),t.onMyLocationClickListener=void 0)})()}generateCallback(t){const e=this.id;return o=>{o.mapId==e&&t(o)}}}var L=c(2340),k=c(5596),Y=c(4844);let S=(()=>{class i{constructor(e,o){this.client=e,this.overlay=o,this.service=new google.maps.DistanceMatrixService,this.directions=new google.maps.DirectionsService}getAddress(e,o){var r=this;return(0,s.Z)(function*(){try{const a=yield r.client.reverseGeocode({params:{latlng:{lat:e,lng:o},key:L.N.apiKey},timeout:5e3});return console.log(a),a}catch(a){r.overlay.showAlert("GeoError",a)}})()}getLatLng(e){var o=this;return(0,s.Z)(function*(){try{return yield o.client.geocode({params:{address:e,key:L.N.apiKey},timeout:5e3})}catch(r){o.overlay.showAlert("GeoError",r),console.log(r)}})()}getDirections(e,o){return(0,s.Z)(function*(){})()}}return i.\u0275fac=function(e){return new(e||i)(n.LFG(Y.Client),n.LFG(k.F))},i.\u0275prov=n.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),B=(()=>{class i{constructor(e,o){this.overlay=e,this.geocode=o,this.locationAddress="Loading.."}createMap(e,o){var r=this;return(0,s.Z)(function*(){try{r.newMap=yield b.create({id:"my-cool-map",element:e,apiKey:L.N.apiKey,config:{center:{lat:5.5122138,lng:7.4919135},zoom:8}}),r.LatLng={lat:o.coords.latitude,lng:o.coords.longitude},r.newMap.setMapType(h.Normal),r.newMap.enableTrafficLayer(!0),yield r.newMap.setCamera({animate:!0,animationDuration:500,zoom:15,coordinate:r.LatLng});const a=yield r.geocode.getAddress(r.LatLng.lat,r.LatLng.lng);r.actualLocation=a.data.results[0].formatted_address,r.locationAddress=a.data.results[1].address_components[0].long_name+" "+a.data.results[1].address_components[1].long_name,r.newMap.enableCurrentLocation(!0)}catch(a){r.overlay.showAlert("Error",a)}})()}CalculateCenter(e){return(0,s.Z)(function*(){var o=0,r=0;for(var a of e)r+=a.geoCode.longitude,o+=a.geoCode.latitude;return o/=e.length,r/=e.length,yield o,{latitude:o,longitude:r}})()}getBoundsZoomLevel(e,o){return(0,s.Z)(function*(){function u(M){var v=Math.sin(M*Math.PI/180),x=Math.log((1+v)/(1-v))/2;return Math.max(Math.min(x,Math.PI),-Math.PI)/2}function g(M,v,x){return Math.floor(Math.log(M/v/x)/Math.LN2)}var f=e.getNorthEast(),m=e.getSouthWest(),y=(u(f.lat())-u(m.lat()))/Math.PI,p=f.lng()-m.lng(),Pe=(p<0?p+360:p)/360,O=g(o.height,256,y),H=g(o.width,256,Pe);return yield Math.min(O,H,21),Math.min(O,H,21)})()}}return i.\u0275fac=function(e){return new(e||i)(n.LFG(k.F),n.LFG(S))},i.\u0275prov=n.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var Q=c(5083);const z=["map"],F=["mapElement"];function G(i,t){1&i&&n._UZ(0,"ion-icon",18)}function q(i,t){1&i&&(n.TgZ(0,"ion-label",19),n._uU(1,"Go ONLINE"),n.qZA())}function W(i,t){1&i&&n._UZ(0,"ion-progress-bar",20)}function K(i,t){if(1&i){const e=n.EpF();n.TgZ(0,"ion-button",14),n.NdJ("click",function(){n.CHM(e);const r=n.oxw(2);return n.KtG(r.SwitchOn())}),n.YNc(1,G,1,0,"ion-icon",15),n.YNc(2,q,2,0,"ion-label",16),n.YNc(3,W,1,0,"ion-progress-bar",17),n.qZA()}if(2&i){const e=n.oxw(2);n.xp6(1),n.Q6J("ngIf",!e.approve),n.xp6(1),n.Q6J("ngIf",!e.approve),n.xp6(1),n.Q6J("ngIf",e.approve)}}function j(i,t){1&i&&n._UZ(0,"ion-icon",18)}function V(i,t){1&i&&(n.TgZ(0,"ion-label",19),n._uU(1,"Go OFFLINE"),n.qZA())}function X(i,t){1&i&&n._UZ(0,"ion-progress-bar",20)}function $(i,t){if(1&i){const e=n.EpF();n.TgZ(0,"ion-button",21),n.NdJ("click",function(){n.CHM(e);const r=n.oxw(2);return n.KtG(r.SwitchOff())}),n.YNc(1,j,1,0,"ion-icon",15),n.YNc(2,V,2,0,"ion-label",16),n.YNc(3,X,1,0,"ion-progress-bar",17),n.qZA()}if(2&i){const e=n.oxw(2);n.xp6(1),n.Q6J("ngIf",!e.approve),n.xp6(1),n.Q6J("ngIf",!e.approve),n.xp6(1),n.Q6J("ngIf",e.approve)}}function ee(i,t){if(1&i&&(n.TgZ(0,"ion-item-group",11),n.YNc(1,K,4,3,"ion-button",12),n.YNc(2,$,4,3,"ion-button",13),n.qZA()),2&i){const e=n.oxw();n.xp6(1),n.Q6J("ngIf",!e.currentState),n.xp6(1),n.Q6J("ngIf",e.currentState)}}function ne(i,t){1&i&&n._UZ(0,"ion-icon",25)}function te(i,t){1&i&&(n.TgZ(0,"ion-label"),n._uU(1,"DEcline"),n.qZA())}function ie(i,t){1&i&&n._UZ(0,"ion-progress-bar",20)}function oe(i,t){if(1&i){const e=n.EpF();n.TgZ(0,"ion-item-group",11)(1,"ion-button",22),n.NdJ("click",function(){n.CHM(e);const r=n.oxw();return n.KtG(r.CancelRide())}),n.YNc(2,ne,1,0,"ion-icon",23),n.YNc(3,te,2,0,"ion-label",24),n.YNc(4,ie,1,0,"ion-progress-bar",17),n.qZA()()}if(2&i){const e=n.oxw();n.xp6(2),n.Q6J("ngIf",!e.approve),n.xp6(1),n.Q6J("ngIf",!e.approve),n.xp6(1),n.Q6J("ngIf",e.approve)}}function re(i,t){1&i&&n._UZ(0,"ion-icon",30)}function ae(i,t){1&i&&(n.TgZ(0,"ion-label"),n._uU(1,"Call Rider"),n.qZA())}function se(i,t){1&i&&n._UZ(0,"ion-progress-bar",20)}function le(i,t){1&i&&n._UZ(0,"ion-icon",25)}function ce(i,t){1&i&&(n.TgZ(0,"ion-label"),n._uU(1,"Cancel"),n.qZA())}function de(i,t){1&i&&n._UZ(0,"ion-progress-bar",20)}function ue(i,t){if(1&i){const e=n.EpF();n.TgZ(0,"ion-item",26)(1,"ion-button",27),n.YNc(2,re,1,0,"ion-icon",28),n.YNc(3,ae,2,0,"ion-label",24),n.YNc(4,se,1,0,"ion-progress-bar",17),n.qZA(),n.TgZ(5,"ion-button",29),n.NdJ("click",function(){n.CHM(e);const r=n.oxw();return n.KtG(r.CancelRide())}),n.YNc(6,le,1,0,"ion-icon",23),n.YNc(7,ce,2,0,"ion-label",24),n.YNc(8,de,1,0,"ion-progress-bar",17),n.qZA()()}if(2&i){const e=n.oxw();n.xp6(2),n.Q6J("ngIf",!e.approve),n.xp6(1),n.Q6J("ngIf",!e.approve),n.xp6(1),n.Q6J("ngIf",e.approve),n.xp6(2),n.Q6J("ngIf",!e.approve),n.xp6(1),n.Q6J("ngIf",!e.approve),n.xp6(1),n.Q6J("ngIf",e.approve)}}function ge(i,t){if(1&i){const e=n.EpF();n.TgZ(0,"ion-item-group",11)(1,"ion-button",31),n.NdJ("click",function(){n.CHM(e);const r=n.oxw();return n.KtG(r.Navigate())}),n._UZ(2,"ion-icon",32),n.TgZ(3,"ion-label",19),n._uU(4,"Navigate"),n.qZA()()()}}function fe(i,t){if(1&i){const e=n.EpF();n.TgZ(0,"ion-fab",33)(1,"ion-fab-button",34),n.NdJ("click",function(){n.CHM(e);const r=n.oxw();return n.KtG(r.resetLocation())}),n._UZ(2,"ion-icon",35),n.qZA()()}}function me(i,t){if(1&i&&(n.TgZ(0,"ion-list",36)(1,"ion-item-group",11)(2,"ion-button",37),n._UZ(3,"ion-icon",38),n.TgZ(4,"ion-label",19),n._uU(5),n.qZA()()()()),2&i){const e=n.oxw();n.xp6(5),n.hij("$",e.earnings,"")}}function _e(i,t){if(1&i&&(n.TgZ(0,"ion-list-header",26)(1,"ion-label",42)(2,"h1",43),n._uU(3),n.qZA(),n.TgZ(4,"p",44),n._uU(5),n.qZA(),n.TgZ(6,"h1",45),n._uU(7,"Time Left "),n.TgZ(8,"strong"),n._uU(9),n.qZA(),n._uU(10," sec(s)"),n.qZA()()()),2&i){const e=n.oxw(2);n.xp6(3),n.AsE("",e.durationText," . ",e.distanceText,""),n.xp6(2),n.Oqu(e.riderInfo.Rider_Location),n.xp6(4),n.Oqu(e.riderInfo.countDown)}}function pe(i,t){1&i&&(n.TgZ(0,"ion-list-header",26)(1,"ion-label",42)(2,"h1",43),n._UZ(3,"ion-skeleton-text",46),n._uU(4," . "),n._UZ(5,"ion-skeleton-text",46),n.qZA(),n.TgZ(6,"p",47),n._UZ(7,"ion-skeleton-text",48),n.qZA(),n.TgZ(8,"h1",45),n._UZ(9,"ion-skeleton-text",46),n.qZA()()()),2&i&&(n.xp6(3),n.Q6J("animated",!0),n.xp6(2),n.Q6J("animated",!0),n.xp6(2),n.Q6J("animated",!0),n.xp6(2),n.Q6J("animated",!0))}function he(i,t){if(1&i){const e=n.EpF();n.TgZ(0,"ion-list",39),n.NdJ("click",function(){n.CHM(e);const r=n.oxw();return n.KtG(r.AcceptRide())}),n.YNc(1,_e,11,4,"ion-list-header",3),n.YNc(2,pe,10,4,"ion-list-header",3),n.TgZ(3,"ion-item-group",11)(4,"ion-button",40),n._UZ(5,"ion-icon",41),n.TgZ(6,"ion-label",19),n._uU(7,"Accept"),n.qZA()()()()}if(2&i){const e=n.oxw();n.xp6(1),n.Q6J("ngIf",e.distanceText),n.xp6(1),n.Q6J("ngIf",!e.distanceText)}}function ve(i,t){1&i&&(n.TgZ(0,"ion-item")(1,"ion-label")(2,"h1"),n._UZ(3,"ion-icon",57),n._uU(4," Cash"),n.qZA()()())}function Ce(i,t){1&i&&(n.TgZ(0,"ion-item")(1,"ion-label")(2,"h1"),n._UZ(3,"ion-icon",58),n._uU(4," Card"),n.qZA()()())}function be(i,t){if(1&i){const e=n.EpF();n.TgZ(0,"ion-button",59),n.NdJ("click",function(){n.CHM(e);const r=n.oxw(2);return n.KtG(r.PickUp())}),n._UZ(1,"ion-icon",60),n.TgZ(2,"ion-label",19),n._uU(3,"Pick Up"),n.qZA()()}}function Le(i,t){if(1&i){const e=n.EpF();n.TgZ(0,"ion-button",59),n.NdJ("click",function(){n.CHM(e);const r=n.oxw(2);return n.KtG(r.DropOff())}),n._UZ(1,"ion-icon",60),n.TgZ(2,"ion-label",19),n._uU(3,"Drop Off"),n.qZA()()}}function ke(i,t){if(1&i){const e=n.EpF();n.TgZ(0,"ion-button",31),n.NdJ("click",function(){n.CHM(e);const r=n.oxw(2);return n.KtG(r.Navigate())}),n._UZ(1,"ion-icon",32),n.TgZ(2,"ion-label",19),n._uU(3,"Navigate"),n.qZA()()}}function ye(i,t){if(1&i&&(n.TgZ(0,"ion-list",49)(1,"ion-list-header",26)(2,"ion-label",50)(3,"h1"),n._uU(4),n.qZA()()(),n.TgZ(5,"div",51)(6,"ion-item")(7,"ion-item")(8,"ion-label")(9,"h1"),n._uU(10),n.qZA(),n.TgZ(11,"p")(12,"strong"),n._uU(13,"Destinaion "),n.qZA(),n._uU(14),n.qZA()()(),n.TgZ(15,"ion-item",52)(16,"ion-avatar"),n._UZ(17,"ion-img",53),n.qZA(),n.TgZ(18,"ion-label")(19,"p"),n._UZ(20,"ion-icon",54),n._uU(21," 5 "),n.qZA()()()(),n.TgZ(22,"ion-item"),n.YNc(23,ve,5,0,"ion-item",24),n.YNc(24,Ce,5,0,"ion-item",24),n.TgZ(25,"ion-item",52)(26,"ion-label")(27,"h1"),n._uU(28),n.qZA()()()()(),n.TgZ(29,"ion-item-group",11),n.YNc(30,be,4,0,"ion-button",55),n.YNc(31,Le,4,0,"ion-button",55),n.YNc(32,ke,4,0,"ion-button",56),n.qZA()()),2&i){const e=n.oxw();n.xp6(4),n.hij("Arrival in ",e.durationText,""),n.xp6(6),n.hij("Your Rider is ",e.riderInfo.Rider_name,""),n.xp6(4),n.Oqu(e.riderInfo.Rider_Destination),n.xp6(3),n.Q6J("src",e.riderInfo.Rider_imgUrl),n.xp6(6),n.Q6J("ngIf",e.cash),n.xp6(1),n.Q6J("ngIf",!e.cash),n.xp6(4),n.hij("$",e.riderInfo.price,""),n.xp6(2),n.Q6J("ngIf",e.trackingStage),n.xp6(1),n.Q6J("ngIf",e.drivingToDestinationStage),n.xp6(1),n.Q6J("ngIf",e.trackingStage)}}const Me=[{path:"",component:(()=>{class i{constructor(e,o,r,a,u,g,f,m,y,p){this.auth=e,this.map=o,this.nav=r,this.platform=a,this.firestore=u,this.database=g,this.ngZone=f,this.geocode=m,this.overlay=y,this.modalCtrl=p,this.profile=null,this.address="Unknown",this.cash=!1,this.state=[],this.showResetLocationButton=!1,this.destinationAddress="Drag To Pick Destination",this.locationAddress="Loading...",this.price=0,this.current_Request_Number=-1,this.approve=!0,this.acceptedState=!1}ngOnInit(){var e=this;return(0,s.Z)(function*(){try{e.EnterBookingStage(),yield T.b.checkPermissions();const o=yield T.b.getCurrentPosition({enableHighAccuracy:!0});e.coordinates=o,yield e.map.createMap(e.mapRef.nativeElement,o),e.mapy=!0,e.LatLng={lat:o.coords.latitude,lng:o.coords.longitude},e.D_LatLng={lat:o.coords.latitude,lng:o.coords.longitude},e.database.getEarnings().subscribe(function(){var r=(0,s.Z)(function*(a){e.earnings=a.Earnings,e.currentState=e.database.profile.onlineState});return function(a){return r.apply(this,arguments)}}()),e.database.getCards().subscribe(function(){var r=(0,s.Z)(function*(a){e.cards=a,e.approve=!1,e.cards.forEach(u=>{console.log(u),1==u.selected&&(e.selected=u,e.selectedCard=u.name,console.log(e.selectedCard))})});return function(a){return r.apply(this,arguments)}}()),e.auth.onAuthStateChanged(r=>{(0,C.cf)((0,C.JU)(e.firestore,"Request",r.uid),function(){var u=(0,s.Z)(function*(g){e.riderInfo=g.data(),null!=e.riderInfo&&(console.log(e.riderInfo),0==e.riderInfo.cancel?e.acceptedState?1==e.riderInfo.start&&e.riderInfo.Driver_car?(e.EnterDrivingToDestinationStage(),e.getDistanceandDirections(g.data())):1==e.riderInfo.stop&&e.riderInfo.Driver_car?(e.EnterBookingStage(),e.ReturnHome(),e.EndRide(g.data())):e.riderInfo.Driver_car&&(e.EnterTrackingStage(),e.getDistanceandDirections(g.data())):e.riderInfo.countDown<=1?(e.ClearRide(),e.FCOUNT=!0):(e.EnterConfirmStage(),1==e.riderInfo.cash&&(e.cash=!0),e.getDistanceandDirections(g.data()),e.map.newMap.enableCurrentLocation(!1)):(!e.driverCleared&&!e.FCOUNT&&(e.ClearRide(),e.overlay.showAlert("Cancelled","Rider cancelled")),e.FCOUNT&&(e.overlay.showAlert("Lost","You Lost the Ride"),yield e.database.deleDriverFromRequest(e.auth.currentUser.uid))))});return function(g){return u.apply(this,arguments)}}())}),e.actualLocation=e.map.actualLocation,e.locationAddress=e.map.locationAddress,e.map.newMap.setOnCameraIdleListener(r=>{e.ngZone.run(()=>{e.showResetLocationButton=!0})})}catch(o){e.overlay.showAlert("Error",o)}})()}EndRide(e){var o=this;return(0,s.Z)(function*(){let a=e.price-.8*e.price;o.overlay.showLoader("Ending Ride.."),yield o.database.createHistory(e),yield o.database.deleDriverFromRequest(o.auth.currentUser.uid),yield o.database.updateEarnings(a+o.earnings),o.SwitchOn(),o.overlay.hideLoader()})()}startTimer(e){var o=this;let r=function U(i=0,t=I.P){return(!(0,N.k)(i)||i<0)&&(i=0),(!t||"function"!=typeof t.schedule)&&(t=I.P),new A.y(e=>(e.add(t.schedule(D,i,{subscriber:e,counter:0,period:i})),e))}(1e3).subscribe((0,s.Z)(function*(){yield o.database.UpdateCountDown(e),0==--e&&r.unsubscribe()}))}ionViewDidLeave(){}chooseCard(e){var o=this;return(0,s.Z)(function*(){console.log(e),o.overlay.showLoader("Selcting Card.."),yield o.database.updateCArd(o.selected.name,o.selected.number,o.selected.type,o.selected.id,!1),o.cards.forEach(function(){var r=(0,s.Z)(function*(a){console.log(a),a.name==e&&(yield o.database.updateCArd(a.name,a.number,a.type,a.id,!0),o.overlay.hideLoader())});return function(a){return r.apply(this,arguments)}}())})()}AcceptRide(){var e=this;return(0,s.Z)(function*(){try{e.acceptedState=!0,e.distanceText&&(yield e.overlay.showLoader(""),yield e.database.PushDriverToRequest(e.coordinates,e.database.profile.Driver_name,e.database.profile.Driver_email,e.database.profile.Driver_phone,e.database.profile.Driver_car,e.database.profile.Driver_cartype,e.database.profile.Driver_plate,e.database.profile.Driver_imgUrl,e.database.profile.Document),e.EnterTrackingStage(),e.overlay.hideLoader())}catch(o){e.overlay.showAlert("Error",o)}})()}resetLocation(){var e=this;return(0,s.Z)(function*(){console.log(e.LatLng),yield e.map.newMap.setCamera({animate:!0,animationDuration:500,zoom:15,coordinate:e.LatLng}),e.showResetLocationButton=!1})()}PickUp(){var e=this;return(0,s.Z)(function*(){e.overlay.showLoader("Picking Up.."),yield e.database.PickRider(),e.overlay.hideLoader()})()}DropOff(){var e=this;return(0,s.Z)(function*(){yield e.database.EndRide()})()}Navigate(){return(0,s.Z)(function*(){})()}SwitchOff(){var e=this;return(0,s.Z)(function*(){e.approve=!0,yield e.database.updateOnlineState(!1),e.approve=!1,e.currentState=!1})()}SwitchOn(){var e=this;return(0,s.Z)(function*(){e.approve=!0,yield e.database.updateOnlineState(!0),e.approve=!1,e.currentState=!0})()}getDistanceandDirections(e){var o=this;return(0,s.Z)(function*(){if(!o.canStart){o.canStart=!0;var r=new google.maps.LatLng(o.LatLng.lat,o.LatLng.lng),a=new google.maps.LatLng(e.Loc_lat,e.Loc_lng);o.D_LatLng={lat:e.Loc_lat,lng:e.Loc_lng};var u={origin:r,destination:a,travelMode:google.maps.TravelMode.DRIVING};o.geocode.directions.route(u,function(){var g=(0,s.Z)(function*(f,m){console.log(m,f),"OK"==m&&(o.direction=f,o.canStart=!1,o.distance=f.routes[0].legs[0].distance.value,o.distanceText=f.routes[0].legs[0].distance.text,o.durationText=f.routes[0].legs[0].duration.text,o.bounds=f.routes[0].bounds,yield o.createAndAddMarkers(o.LatLng,o.D_LatLng,o.bounds))});return function(f,m){return g.apply(this,arguments)}}())}})()}ReturnHome(){var e=this;return(0,s.Z)(function*(){e.canStart=!1,e.distanceText=null,e.durationText=null,e.FCOUNT=!1,e.riderInfo=null,e.marker1&&(yield e.map.newMap.removeMarker(e.marker1),e.marker1=null,console.log("removed ",e.marker1)),e.marker2&&(yield e.map.newMap.removeMarker(e.marker2),e.marker2=null,console.log("removed ",e.marker2)),e.EnterBookingStage(),yield e.map.newMap.setCamera({animate:!0,animationDuration:500,zoom:15,coordinate:e.LatLng})})()}CancelRide(){var e=this;return(0,s.Z)(function*(){e.driverCleared=!0,e.overlay.showLoader("Cancelling Ride.."),yield e.database.RejectRider(),yield e.database.deleDriverFromRequest(e.auth.currentUser.uid),e.overlay.hideLoader(),e.overlay.showAlert("Cancelled","You cancelled"),e.ReturnHome()})()}ClearRide(){var e=this;return(0,s.Z)(function*(){e.overlay.showLoader("Clearing Ride.."),yield e.database.RejectRider(),yield e.database.deleDriverFromRequest(e.auth.currentUser.uid),e.overlay.hideLoader(),e.ReturnHome()})()}createAndAddMarkers(e,o,r){var a=this;return(0,s.Z)(function*(){a.marker1||(a.marker1=yield a.map.newMap.addMarker({coordinate:e,iconUrl:"https://i.ibb.co/KDy365b/hatchback.png",title:"My 2"})),a.marker2||(a.marker2=yield a.map.newMap.addMarker({coordinate:o,iconUrl:"https://i.ibb.co/bWx9V64/favourite.png",title:"My 2"}));const u=[{geoCode:{latitude:e.lat,longitude:e.lng}},{geoCode:{latitude:o.lat,longitude:o.lng}}];yield a.map.newMap.setPadding({top:300,left:150,right:150,bottom:1200});let g={lat:(yield a.map.CalculateCenter(u)).latitude,lng:(yield a.map.CalculateCenter(u)).longitude},f={height:a.mapRef.nativeElement.offsetHeight/2,width:a.mapRef.nativeElement.offsetWidth};yield a.map.newMap.setCamera({animate:!0,animationDuration:500,zoom:yield a.map.getBoundsZoomLevel(r,f),coordinate:g,bearing:0})})()}EnterBookingStage(){this.bookingStage=!0,this.confirmStage=!1,this.trackingStage=!1,this.mapPinStage=!1,this.drivingToDestinationStage=!1}EnterConfirmStage(){this.bookingStage=!1,this.confirmStage=!0,this.trackingStage=!1,this.mapPinStage=!1,this.drivingToDestinationStage=!1}EnterSearchingStage(){this.bookingStage=!1,this.confirmStage=!1,this.trackingStage=!1,this.mapPinStage=!1,this.drivingToDestinationStage=!1}EnterNoDriverStage(){this.bookingStage=!1,this.confirmStage=!1,this.trackingStage=!1,this.mapPinStage=!1,this.drivingToDestinationStage=!1}EnterTrackingStage(){this.bookingStage=!1,this.confirmStage=!1,this.trackingStage=!0,this.mapPinStage=!1,this.drivingToDestinationStage=!1}EnterDrivingToDestinationStage(){this.bookingStage=!1,this.confirmStage=!1,this.trackingStage=!1,this.mapPinStage=!1,this.drivingToDestinationStage=!0}}return i.\u0275fac=function(e){return new(e||i)(n.Y36(R.gx),n.Y36(B),n.Y36(d.SH),n.Y36(d.t4),n.Y36(C.gg),n.Y36(Q.o),n.Y36(n.R0b),n.Y36(S),n.Y36(k.F),n.Y36(d.IN))},i.\u0275cmp=n.Xpm({type:i,selectors:[["app-home"]],viewQuery:function(e,o){if(1&e&&(n.Gf(z,5),n.Gf(F,5)),2&e){let r;n.iGM(r=n.CRH())&&(o.mapRef=r.first),n.iGM(r=n.CRH())&&(o.mapElement=r.first)}},decls:15,vars:10,consts:[[1,"ion-padding-top","top_bar"],["lines","none"],["class","ion-margin-horizontal ion-margin-bottom",4,"ngIf"],["class","ion-margin-bottom",4,"ngIf"],[3,"fullscreen"],["map",""],[1,"ion-no-border",3,"translucent"],["vertical","top","horizontal","end",4,"ngIf"],["class","shadow-top","lines","full",4,"ngIf"],["class","shadow-top book","lines","none",3,"click",4,"ngIf"],["class","shadow-top","lines","none",4,"ngIf"],[1,"ion-margin-horizontal","ion-margin-bottom"],["shape","round","class","main-button","color","danger","size","large","expand","block",3,"click",4,"ngIf"],["shape","round","class","main-button","color","success","size","large","expand","block",3,"click",4,"ngIf"],["shape","round","color","danger","size","large","expand","block",1,"main-button",3,"click"],["slot","start","name","power-sharp","color","light",4,"ngIf"],["color","light",4,"ngIf"],["color","light","type","indeterminate",4,"ngIf"],["slot","start","name","power-sharp","color","light"],["color","light"],["color","light","type","indeterminate"],["shape","round","color","success","size","large","expand","block",1,"main-button",3,"click"],["color","danger","shape","round","size","large","expand","block",1,"main-button",3,"click"],["slot","start","name","trash-sharp",4,"ngIf"],[4,"ngIf"],["slot","start","name","trash-sharp"],[1,"ion-margin-bottom"],["slot","start","color","primary","shape","round","size","large",1,"main-button"],["slot","start","name","call-sharp",4,"ngIf"],["slot","end","color","danger","shape","round","size","large",1,"main-button",3,"click"],["slot","start","name","call-sharp"],["shape","round","color","primary","size","large","type","submit","expand","block",1,"main-button",3,"click"],["slot","start","name","map-sharp","color","light"],["vertical","top","horizontal","end"],["color","light",3,"click"],["name","locate"],["lines","full",1,"shadow-top"],["shape","round","color","primary","size","large","type","submit","expand","block",1,"main-button"],["slot","start","name","cash-sharp","color","light"],["lines","none",1,"shadow-top","book",3,"click"],["shape","round","fill","clear","color","success","size","large","type","submit","expand","block",1,"main-button"],["color","light","slot","start","name","checkmark-sharp"],[1,"ion-padding"],[1,"accept"],[2,"font-size","1em","padding","12px","color","white"],[1,"acceptTimer","ion-text-center"],[3,"animated"],[2,"font-size","1em","padding","10px","color","white"],[2,"width","160px",3,"animated"],["lines","none",1,"shadow-top"],[1,"ion-text-center"],[1,"card"],[1,"price"],[3,"src"],["slot","icon-only","color","secondary","name","star"],["shape","round","class","main-button","color","success","size","large","type","submit","expand","block",3,"click",4,"ngIf"],["shape","round","class","main-button","color","primary","size","large","type","submit","expand","block",3,"click",4,"ngIf"],["color","primary","slot","icon-only","name","cash"],["color","primary","slot","icon-only","name","card"],["shape","round","color","success","size","large","type","submit","expand","block",1,"main-button",3,"click"],["slot","start","name","checkmark-sharp","color","light"]],template:function(e,o){1&e&&(n.TgZ(0,"ion-toolbar",0)(1,"ion-list",1),n.YNc(2,ee,3,2,"ion-item-group",2),n.YNc(3,oe,5,3,"ion-item-group",2),n.YNc(4,ue,9,6,"ion-item",3),n.YNc(5,ge,5,0,"ion-item-group",2),n.qZA()(),n.TgZ(6,"ion-content",4),n._UZ(7,"capacitor-google-maps",null,5),n.qZA(),n.TgZ(9,"ion-footer",6),n.YNc(10,fe,3,0,"ion-fab",7),n.TgZ(11,"ion-row"),n.YNc(12,me,6,1,"ion-list",8),n.YNc(13,he,8,2,"ion-list",9),n.YNc(14,ye,33,10,"ion-list",10),n.qZA()()),2&e&&(n.xp6(2),n.Q6J("ngIf",o.bookingStage),n.xp6(1),n.Q6J("ngIf",o.confirmStage),n.xp6(1),n.Q6J("ngIf",o.trackingStage),n.xp6(1),n.Q6J("ngIf",o.drivingToDestinationStage),n.xp6(1),n.Q6J("fullscreen",!0),n.xp6(3),n.Q6J("translucent",!0),n.xp6(1),n.Q6J("ngIf",o.bookingStage&&o.showResetLocationButton),n.xp6(2),n.Q6J("ngIf",o.bookingStage),n.xp6(1),n.Q6J("ngIf",o.confirmStage),n.xp6(1),n.Q6J("ngIf",o.trackingStage||o.drivingToDestinationStage))},dependencies:[P.O5,d.BJ,d.YG,d.W2,d.IJ,d.W4,d.fr,d.gu,d.Xz,d.Ie,d.Ub,d.Q$,d.q_,d.yh,d.X7,d.Nd,d.CK,d.sr],styles:["capacitor-google-maps[_ngcontent-%COMP%]{display:inline-block;width:100%;height:100vh}@keyframes slide-top{0%{transform:translateY(100%)}to{transform:translateY(0)}}@keyframes slide-bottom{to{transform:translateY(50%)}0%{transform:translateY(0)}}.slide-bottom[_ngcontent-%COMP%]{animation:slide-bottom .5s cubic-bezier(.25,.46,.45,.94) both}.slide-top[_ngcontent-%COMP%]{animation:slide-top .5s cubic-bezier(.25,.46,.45,.94) both}.centerPin[_ngcontent-%COMP%]{animation-name:slide-top;animation-duration:.8s}.bottomItems[_ngcontent-%COMP%]{animation-name:slide-top;animation-duration:.5s}ion-skeleton-text[_ngcontent-%COMP%]{--background: rgba(0, 98, 255, .625)}ion-content[_ngcontent-%COMP%]{--background: transparent;margin-top:20px}ion-footer[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]{padding-top:5vh;background:transparent;display:block}ion-footer[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]   ion-fab-button[_ngcontent-%COMP%]{margin-right:2.5vh}ion-footer[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]{border-radius:20px 20px 0 0}ion-footer[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-list-header[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-weight:700;font-size:1.8rem}ion-footer[_ngcontent-%COMP%]   ion-fab[_ngcontent-%COMP%]{margin-top:-40px}ion-footer[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   .payment[_ngcontent-%COMP%]{font-size:1.1em;color:var(--ion-color-dark);--background: var(--ion-color-light)}ion-footer[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   .payment[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{color:var(--ion-color-dark);--inner-padding-bottom: 1px;--inner-padding-end: 0;--inner-padding-start: 0;--inner-padding-top: 0;--background: var(--ion-color-light)}ion-footer[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   .payment[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ion-color-dark)}ion-skeleton-text[_ngcontent-%COMP%]{--background: rgba(188, 232, 198, .962)}.accept[_ngcontent-%COMP%]{font-size:1.3em;padding:12px}.unbook[_ngcontent-%COMP%]{background:#0a602d}.book[_ngcontent-%COMP%]{background:var(--ion-color-success)}.center-button[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;display:flex;justify-content:center}.acceptTimer[_ngcontent-%COMP%]{font-size:1.3em;color:#f0f8ff;margin-right:auto;background:var(--ion-color-danger);padding:12px;border-radius:100px;border:1.3px solid aliceblue}.centerElem[_ngcontent-%COMP%]{justify-content:center;align-items:center}.pickMe[_ngcontent-%COMP%]{height:300px}.price[_ngcontent-%COMP%]{margin-left:auto;flex:.7}.shadow-top[_ngcontent-%COMP%]{box-shadow:0 -1.5px 1.5px #c4c4c46a;animation-name:slide-top;animation-duration:.6s}.top_bar[_ngcontent-%COMP%]{box-shadow:0 1.5px 1.5px #c4c4c46a}.card[_ngcontent-%COMP%]{box-shadow:0 -1.5px 1.5px #c4c4c46a}.main-button[_ngcontent-%COMP%]{color:var(--ion-color-dark);--background: var(--ion-color-light-shade)}.preview[_ngcontent-%COMP%]{margin-top:50px;display:flex;justify-content:center}.fallback[_ngcontent-%COMP%]{width:128px;height:128px;border-radius:50%;background:#bfbfbf;display:flex;justify-content:center;align-items:center;font-weight:500}.map[_ngcontent-%COMP%]{width:100%;height:1024px;padding-bottom:100%}"]}),i})()}];let xe=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=n.oAB({type:i}),i.\u0275inj=n.cJS({imports:[w.Bz.forChild(Me),w.Bz]}),i})(),Ze=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=n.oAB({type:i}),i.\u0275inj=n.cJS({imports:[P.ez,E.u5,d.Pc,xe]}),i})()}}]);